<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Couchbase Lite: CBLView Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Couchbase Lite</div>
   <div id="projectbrief">Objective-C API for iOS and Mac OS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('interfaceCBLView.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#properties">Properties</a>  </div>
  <div class="headertitle">
<div class="title">CBLView Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="CBLView" -->
<p>A "view" in a CouchbaseLite database -- essentially a persistent index managed by map/reduce.  
 <a href="interfaceCBLView.html#details">More...</a></p>

<p><code>#import &lt;<a class="el" href="CBLView_8h_source.html">CBLView.h</a>&gt;</code></p>

<p><a href="classCBLView-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interfaceCBLView.html#a1aefb4c448b91a517742edfc9ad47ecd">setMapBlock:reduceBlock:version:</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a view's functions.  <a href="#a1aefb4c448b91a517742edfc9ad47ecd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interfaceCBLView.html#a4a18484f5329cef9793a6081852317e0">setMapBlock:version:</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a view that has no reduce function.  <a href="#a4a18484f5329cef9793a6081852317e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interfaceCBLView.html#a39953c0a0e82022a55f0632d46836fec">removeIndex</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes the view's persistent index.  <a href="#a39953c0a0e82022a55f0632d46836fec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interfaceCBLView.html#a327fc1988a559452f3341a07ac593946">deleteView</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes the view, persistently.  <a href="#a327fc1988a559452f3341a07ac593946"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(<a class="el" href="interfaceCBLQuery.html">CBLQuery</a> *)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interfaceCBLView.html#a9eba2ddac8526ac02b4d79163085bd53">query</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new query object for this view.  <a href="#a9eba2ddac8526ac02b4d79163085bd53"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(NSNumber *)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interfaceCBLView.html#a29c9a1a03125cbc89eb75a20bc1c30a4">totalValues:</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility function to use in reduce blocks.  <a href="#a29c9a1a03125cbc89eb75a20bc1c30a4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interfaceCBLView.html#abe26ed16a8fbf91e60980dea1eb89a3d">setCompiler:</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers an object that can compile map/reduce functions from source code.  <a href="#abe26ed16a8fbf91e60980dea1eb89a3d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(id&lt; <a class="el" href="protocolCBLViewCompiler-p.html">CBLViewCompiler</a> &gt;)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interfaceCBLView.html#a9782be8c8c994eaa685176fd8bce1b0a">compiler</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The registered object, if any, that can compile map/reduce functions from source code.  <a href="#a9782be8c8c994eaa685176fd8bce1b0a"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="properties"></a>
Properties</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfaceCBLDatabase.html">CBLDatabase</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceCBLView.html#ae8b25fbdafde7f03b1b12c01d2e158ec">database</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The database that owns this view.  <a href="#ae8b25fbdafde7f03b1b12c01d2e158ec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSString *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceCBLView.html#aeccd0e3db8047111f0fdd5738c910a59">name</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The name of the view.  <a href="#aeccd0e3db8047111f0fdd5738c910a59"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CBLMapBlock&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceCBLView.html#ab8f3671f29a616264f5aaff5d9ea0769">mapBlock</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The map function that controls how index rows are created from documents.  <a href="#ab8f3671f29a616264f5aaff5d9ea0769"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CBLReduceBlock&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceCBLView.html#a6b68872edd92ff2b57f482c1f61f10b1">reduceBlock</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The optional reduce function, which aggregates together multiple rows.  <a href="#a6b68872edd92ff2b57f482c1f61f10b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9054cf28c3b8e4c2a0c25505b0169bb9"></a><!-- doxytag: member="CBLView::stale" ref="a9054cf28c3b8e4c2a0c25505b0169bb9" args="" -->
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceCBLView.html#a9054cf28c3b8e4c2a0c25505b0169bb9">stale</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the view's index currently out of date? <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">SInt64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceCBLView.html#a14c358544fd4c923bf79f07b93e51655">lastSequenceIndexed</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The last sequence number indexed so far.  <a href="#a14c358544fd4c923bf79f07b93e51655"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>A "view" in a CouchbaseLite database -- essentially a persistent index managed by map/reduce. </p>
<p>The view can be queried using a <a class="el" href="interfaceCBLQuery.html" title="Represents a query of a CouchbaseLite &#39;view&#39;, or of a view-like resource like _all_documents.">CBLQuery</a>. </p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a1aefb4c448b91a517742edfc9ad47ecd"></a><!-- doxytag: member="CBLView::setMapBlock:reduceBlock:version:" ref="a1aefb4c448b91a517742edfc9ad47ecd" args="(CBLMapBlock mapBlock,[reduceBlock] CBLReduceBlock reduceBlock,[version](nonnull(1, 3 __attribute__)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (BOOL) setMapBlock: </td>
          <td></td>
          <td class="paramtype">(CBLMapBlock)&#160;</td>
          <td class="paramname"><em>mapBlock</em></td>
        </tr>
        <tr>
          <td class="paramkey">reduceBlock:</td>
          <td></td>
          <td class="paramtype">(CBLReduceBlock)&#160;</td>
          <td class="paramname"><em>reduceBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines a view's functions. </p>
<p>The view's definition is given as an Objective-C block (or NULL to delete the view). The body of the block should call the 'emit' block (passed in as a paramter) for every key/value pair it wants to write to the view. Since the function itself is obviously not stored in the database (only a unique string idenfitying it), you must re-define the view on every launch of the app! If the database needs to rebuild the view but the function hasn't been defined yet, it will fail and the view will be empty, causing weird problems later on. It is very important that this block be a law-abiding map function! As in other languages, it must be a "pure" function, with no side effects, that always emits the same values given the same input document. That means that it should not access or change any external state; be careful, since blocks make that so easy that you might do it inadvertently! The block may be called on any thread, or on multiple threads simultaneously. This won't be a problem if the code is "pure" as described above, since it will as a consequence also be thread-safe. </p>

</div>
</div>
<a class="anchor" id="a4a18484f5329cef9793a6081852317e0"></a><!-- doxytag: member="CBLView::setMapBlock:version:" ref="a4a18484f5329cef9793a6081852317e0" args="(CBLMapBlock mapBlock,[version](nonnull(1, 2 __attribute__)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (BOOL) setMapBlock: </td>
          <td></td>
          <td class="paramtype">(CBLMapBlock)&#160;</td>
          <td class="paramname"><em>mapBlock</em></td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines a view that has no reduce function. </p>
<p>See -setMapBlock:reduceBlock:version: for more details. </p>

</div>
</div>
<a class="anchor" id="a39953c0a0e82022a55f0632d46836fec"></a><!-- doxytag: member="CBLView::removeIndex" ref="a39953c0a0e82022a55f0632d46836fec" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) removeIndex </td>
          <td></td>
          <td class="paramname"></td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes the view's persistent index. </p>
<p>It will be regenerated on the next query. </p>

</div>
</div>
<a class="anchor" id="a327fc1988a559452f3341a07ac593946"></a><!-- doxytag: member="CBLView::deleteView" ref="a327fc1988a559452f3341a07ac593946" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) deleteView </td>
          <td></td>
          <td class="paramname"></td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes the view, persistently. </p>

</div>
</div>
<a class="anchor" id="a9eba2ddac8526ac02b4d79163085bd53"></a><!-- doxytag: member="CBLView::query" ref="a9eba2ddac8526ac02b4d79163085bd53" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (<a class="el" href="interfaceCBLQuery.html">CBLQuery</a>*) query </td>
          <td></td>
          <td class="paramname"></td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a new query object for this view. </p>
<p>The query can be customized and then executed. </p>

</div>
</div>
<a class="anchor" id="a29c9a1a03125cbc89eb75a20bc1c30a4"></a><!-- doxytag: member="CBLView::totalValues:" ref="a29c9a1a03125cbc89eb75a20bc1c30a4" args="(NSArray *values)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (NSNumber*) totalValues: </td>
          <td></td>
          <td class="paramtype">(NSArray *)&#160;</td>
          <td class="paramname"><em>values</em></td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Utility function to use in reduce blocks. </p>
<p>Totals an array of NSNumbers. </p>

</div>
</div>
<a class="anchor" id="abe26ed16a8fbf91e60980dea1eb89a3d"></a><!-- doxytag: member="CBLView::setCompiler:" ref="abe26ed16a8fbf91e60980dea1eb89a3d" args="(id&lt; CBLViewCompiler &gt; compiler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (void) setCompiler: </td>
          <td></td>
          <td class="paramtype">(id&lt; <a class="el" href="protocolCBLViewCompiler-p.html">CBLViewCompiler</a> &gt;)&#160;</td>
          <td class="paramname"><em>compiler</em></td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Registers an object that can compile map/reduce functions from source code. </p>

</div>
</div>
<a class="anchor" id="a9782be8c8c994eaa685176fd8bce1b0a"></a><!-- doxytag: member="CBLView::compiler" ref="a9782be8c8c994eaa685176fd8bce1b0a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (id&lt;<a class="el" href="protocolCBLViewCompiler-p.html">CBLViewCompiler</a>&gt;) compiler </td>
          <td></td>
          <td class="paramname"></td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The registered object, if any, that can compile map/reduce functions from source code. </p>

</div>
</div>
<hr/><h2>Property Documentation</h2>
<a class="anchor" id="ae8b25fbdafde7f03b1b12c01d2e158ec"></a><!-- doxytag: member="CBLView::database" ref="ae8b25fbdafde7f03b1b12c01d2e158ec" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (<a class="el" href="interfaceCBLDatabase.html">CBLDatabase</a>*) database<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The database that owns this view. </p>

</div>
</div>
<a class="anchor" id="aeccd0e3db8047111f0fdd5738c910a59"></a><!-- doxytag: member="CBLView::name" ref="aeccd0e3db8047111f0fdd5738c910a59" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSString*) name<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The name of the view. </p>

</div>
</div>
<a class="anchor" id="ab8f3671f29a616264f5aaff5d9ea0769"></a><!-- doxytag: member="CBLView::mapBlock" ref="ab8f3671f29a616264f5aaff5d9ea0769" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (CBLMapBlock) mapBlock<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The map function that controls how index rows are created from documents. </p>

</div>
</div>
<a class="anchor" id="a6b68872edd92ff2b57f482c1f61f10b1"></a><!-- doxytag: member="CBLView::reduceBlock" ref="a6b68872edd92ff2b57f482c1f61f10b1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (CBLReduceBlock) reduceBlock<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The optional reduce function, which aggregates together multiple rows. </p>

</div>
</div>
<a class="anchor" id="a14c358544fd4c923bf79f07b93e51655"></a><!-- doxytag: member="CBLView::lastSequenceIndexed" ref="a14c358544fd4c923bf79f07b93e51655" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (SInt64) lastSequenceIndexed<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The last sequence number indexed so far. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Source/API/<a class="el" href="CBLView_8h_source.html">CBLView.h</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="interfaceCBLView.html">CBLView</a>      </li>
      <li class="footer">Generated on Mon Jul 22 2013 21:41:22 for Couchbase Lite by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
